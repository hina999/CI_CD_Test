@using FXAdminTransferConnex.Entities;
@using FXAdminTransferConnexApp
@model List<ReconciliationTeamMemberModel>
<FXAdminTransferConnex.Entities.ReconciliationTeamMemberModel>
    @{
        ViewBag.Title = "TeamTopReport";
        Layout = "~/Views/Shared/_Layout.cshtml";
        var GetCurrentYear = (ReconciliationTeamModel)ViewData["ReconciliationTeamCurrentYearReport"];
        var GetCurrentMonth = (ReconciliationTeamModel)ViewData["ReconciliationTeamCurrentMonthReport"];
        var Lead = Model.Max(x => x.LeadCount);
        var Reg = Model.Max(x => x.REGCount);
        var Rnc = Model.Max(x => x.RNCCount);
        var Ding = Model.Max(x => x.DingCount);
    }
    <style>
        .panel-default > .panel-heading {
            color: white;
            background-color: #2c52ba;
        }

        .avatar {
            border-radius: 50%;
            font-size: 40px;
            color: #fff;
            text-align: center;
            background: #341535;
            width: 75px;
            height: 75px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .container {
            width: 100%;
            padding: 0px
        }

        .currentreport {
            display: flex;
            justify-content: center;
            padding-bottom: 45px;
        }

        .detail {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #fff;
            padding: 15px;
            border-radius: 4px;
            box-shadow: 0 0 6px 1px #ccc;
            max-width: 33.33%;
            width: 33.33%;
            margin-right: 15px;
        }

        .header .detail:last-child {
            margin-right: 0px;
        }

        .header {
            display: flex;
            justify-content: space-evenly;
        }

        h3 {
            font-size: 16px;
            margin-left: 15px;
        }

        .box-1, .box-2 {
            max-width: 50%;
            display: block;
            width: 50%;
        }

        table {
            width: 100%;
        }

            table tr th {
                text-align: center;
            }

        .current-data {
            display: flex;
            flex-direction: column;
            width: 100%;
        }

            .current-data h3 {
                margin-bottom: 3px;
                margin-top: 3px;
            }

            .current-data.rnc h3:first-child {
                color: #2E72C4;
                font-weight: 600;
            }

            .current-data.reg h3:first-child {
                color: #00B050;
                font-weight: 600;
            }

            .current-data.ding h3:first-child {
                color: #FF0000;
                font-weight: 600;
            }

            .current-data.leads h3:first-child {
                color: #7030A0;
                font-weight: 600;
            }

        .table-responsive {
            overflow-x: hidden;
        }

        @@media (max-width:767px) {
            .header {
                flex-wrap: wrap;
            }

            .detail {
                max-width: 100%;
                width: 100%;
                margin-right: 0;
                margin-bottom: 15px;
            }

            .currentreport {
                overflow: hidden;
                flex-wrap: wrap;
            }

            .box-1, .box-2 {
                max-width: 100%;
                width: 100%;
            }

            .table-responsive {
                overflow-x: auto;
            }
        }

        #tblCurrenMonthReport tr {
            height: 40px;
        }

            #tblCurrenMonthReport tr td:first-child {
                font-size: 18px;
            }

            #tblCurrenMonthReport tr td:not(:first-child) {
                font-weight: bold;
            }


        #tblCurrenYearReport tr {
            height: 40px;
        }

            #tblCurrenYearReport tr td:first-child {
                font-size: 18px;
            }

            #tblCurrenYearReport tr td:not(:first-child) {
                font-weight: bold;
            }
    </style>
    <div class="content">
        <div class="container">
            <div class="header">
                @if (Model != null && Model.Count != 0)
                {
                    foreach (var item in Model)
                    {
                        if (item.REGCount == Reg)
                        {
                            <div class="detail">
                                @if (string.IsNullOrEmpty(item.ImageName))
                                {
                                    <div class="avatar">
                                        <span>@item.UserInitials</span>
                                    </div>
                                }
                                else
                                {
                                    <img src="@item.ImageURL" class="avatar" alt="" />
                                }
                                <div class="current-data reg">
                                    <h3>Top Reg</h3>
                                    <h3>@item.FullName</h3>
                                    <h3>@item.REGCount Reg</h3>
                                </div>
                            </div>
                        }
                        if (item.RNCCount == Rnc)
                        {
                            <div class="detail">
                                @if (string.IsNullOrEmpty(item.ImageName))
                                {
                                    <div class="avatar">
                                        <span>@item.UserInitials</span>
                                    </div>
                                }
                                else
                                {
                                    <img src="@item.ImageURL" class="avatar" alt="" />
                                }
                                <div class="current-data rnc">
                                    <h3>Top R/C</h3>
                                    <h3>@item.FullName</h3>
                                    <h3>@item.RNCCount R/C</h3>
                                </div>
                            </div>
                        }
                        if (item.DingCount == Ding)
                        {
                            <div class="detail">
                                @if (string.IsNullOrEmpty(item.ImageName))
                                {
                                    <div class="avatar">
                                        <span>@item.UserInitials</span>
                                    </div>
                                }
                                else
                                {
                                    <img src="@item.ImageURL" class="avatar" alt="" />
                                }
                                <div class="current-data ding">
                                    <h3>Top Ding</h3>
                                    <h3>@item.FullName</h3>
                                    <h3>@item.DingCount Ding</h3>
                                </div>
                            </div>
                        }
                        if (item.LeadCount == Lead)
                        {
                            <div class="detail">
                                @if (string.IsNullOrEmpty(item.ImageName))
                                {
                                    <div class="avatar">
                                        <span>@item.UserInitials</span>
                                    </div>
                                }
                                else
                                {
                                    <img src="@item.ImageURL" class="avatar" alt="" />
                                }
                                <div class="current-data leads">
                                    <h3>Top Leads</h3>
                                    <h3>@item.FullName</h3>
                                    <h3>@item.LeadCount Leads</h3>
                                </div>
                            </div>
                        }
                    }
                }
                else
                {
                    <span>No Data Available </span>
                }
            </div>
            <hr />
        </div>
        <div class="currentreport">
            <div class="box-1">
                <div class="panel panel-default text-center">
                    <div class="panel-heading">
                        <h5>Current month</h5>
                    </div>
                </div>
                <div class="table-responsive">
                    <table id="tblCurrenMonthReport" class="table display table-borderless" style="margin-left:0px;font-size:16px; background:#ffffff; border-bottom:solid 1px #c6c6c6;">
                        <thead style=" background-color: #e7eeff;">
                            <tr style="border: 1px solid #c6c6c6">
                                <th style="padding:6px 12px;text-align: left;">Name</th>
                                <th style="padding: 6px 12px;color: #7030A0;">Leads</th>
                                <th style="padding: 6px 12px;color: #2E72C4;">R/C</th>
                                <th style="padding: 6px 12px;color: #00B050;">Reg</th>
                                <th style="padding: 6px 12px;color: #FF0000;">Dings</th>
                                <th style="text-align: right;padding: 6px 6px;">Comms (£)</th>
                            </tr>
                        </thead>
                        <tbody>
                            @{
                                long? traderId = 0;
                                int RecordCount = 0;
                                int LeadCount = 0;
                                int RNCCount = 0;
                                int REGCount = 0;
                                int DingCount = 0;
                                decimal Commission = 0;
                                if (GetCurrentMonth != null)
                                {
                                    foreach (var item in GetCurrentMonth.MemberList)
                                    {
                                        RecordCount = RecordCount + 1;
                                        LeadCount = LeadCount + item.LeadCount.Value;
                                        RNCCount = RNCCount + item.RNCCount.Value;
                                        REGCount = REGCount + item.REGCount.Value;
                                        DingCount = DingCount + item.DingCount.Value;
                                        Commission = Commission + item.Commission.Value;
                                        if (traderId != item.TraderId)
                                        {
                                            if (traderId != 0)
                                            {
                                                var newList = GetCurrentMonth.MemberList.Where(x => x.TraderId == traderId);
                                                <tr style="border-left: 1px solid black;border-right: 1px solid black;">
                                                    <td align="center">@newList.Sum(x => x.LeadCount)</td>
                                                    <td align="center">@newList.Sum(x => x.RNCCount)</td>
                                                    <td align="center">@newList.Sum(x => x.REGCount)</td>
                                                    <td align="center">@newList.Sum(x => x.DingCount)</td>
                                                    <td align="right">@newList.Sum(x => x.Commission).Value.ToString("n2")</td>
                                                </tr>
                                            }
                                            <tr style="border-left: 1px solid #c6c6c6;border-right: 1px solid #c6c6c6;">
                                                <td align="left" style="padding: 1px 5px;">@item.FullName</td>
                                                <td align="center" style="padding: 1px 5px;color:#7030A0;">@item.LeadCount</td>
                                                <td align="center" style="padding: 1px 5px;color:#2E72C4;">@item.RNCCount</td>
                                                <td align="center" style="padding: 1px 5px;color:#00B050;">@item.REGCount</td>
                                                <td align="center" style="padding: 1px 5px;color:#FF0000;">@item.DingCount</td>
                                                <td align="right" style="padding: 1px 5px;">@item.Commission.Value.ToString("n2")</td>
                                            </tr>
                                        }
                                        else
                                        {
                                            <tr style="border-left: 1px solid #c6c6c6;border-right: 1px solid #c6c6c6;">
                                                <td align="left" style="padding: 1px 5px;">@item.FullName</td>
                                                <td align="center" style="padding: 1px 5px;color:#7030A0;">@item.LeadCount</td>
                                                <td align="center" style="padding: 1px 5px;color:#2E72C4;">@item.RNCCount</td>
                                                <td align="center" style="padding: 1px 5px;color:#00B050;">@item.REGCount</td>
                                                <td align="center" style="padding: 1px 5px;color:#FF0000;">@item.DingCount</td>
                                                <td align="right" style="padding: 1px 5px;">@item.Commission.Value.ToString("n2")</td>
                                            </tr>
                                        }
                                        traderId = item.TraderId;
                                    }
                                    @*
                                        <tr style="border-top: 1px solid black;">
                                           <td style="padding:10px 30px;" colspan="6"></td>
                                        </tr>
                                    *@
                                }
                            }
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="box-2">
                <div class="panel panel-default text-center">
                    <div class="panel-heading">
                        <h5>Current Year</h5>
                    </div>
                </div>
                <div class="table-responsive">
                    <table id="tblCurrenYearReport" class="table display table-borderless" style="margin-left: 5px;font-size: 16px;background: #ffffff;border-bottom: solid 1px #c6c6c6;">
                        <thead style=" background-color: #e7eeff;">
                            <tr style="border: 1px solid #c6c6c6">
                                <th style="padding: 6px 11px;text-align: left;">Name</th>
                                <th style="padding: 6px 11px;text-align: center;color: #7030A0;">Leads</th>
                                <th style="padding: 6px 11px;text-align: center;color: #2E72C4;">R/C</th>
                                <th style="padding: 6px 11px;text-align: center;color: #00B050;">Reg</th>
                                <th style="padding: 6px 11px;text-align: center;color: #FF0000;">Dings</th>
                                <th style="padding: 6px 6px;text-align: right;">Comms (£)</th>
                            </tr>
                        </thead>
                        <tbody>
                            @{
                                long? traderIdd = 0;
                                int RecordCountt = 0;
                                int LeadCountt = 0;
                                int RNCCountt = 0;
                                int REGCountt = 0;
                                int DingCountt = 0;
                                decimal Commissionn = 0;
                                if (GetCurrentYear != null)
                                {
                                    foreach (var item in GetCurrentYear.MemberList)
                                    {
                                        RecordCountt = RecordCountt + 1;
                                        LeadCountt = LeadCountt + item.LeadCount.Value;
                                        RNCCountt = RNCCountt + item.RNCCount.Value;
                                        REGCountt = REGCountt + item.REGCount.Value;
                                        DingCountt = DingCountt + item.DingCount.Value;
                                        Commissionn = Commissionn + item.Commission.Value;
                                        if (traderIdd != item.TraderId)
                                        {
                                            if (traderIdd != 0)
                                            {
                                                var newList = GetCurrentYear.MemberList.Where(x => x.TraderId == traderIdd);
                                                <tr style="border-left: 1px solid black;border-right: 1px solid black;">
                                                    <td align="center">@newList.Sum(x => x.LeadCount)</td>
                                                    <td align="center">@newList.Sum(x => x.RNCCount)</td>
                                                    <td align="center">@newList.Sum(x => x.REGCount)</td>
                                                    <td align="center">@newList.Sum(x => x.DingCount)</td>
                                                    <td align="right">@newList.Sum(x => x.Commission).Value.ToString("n2")</td>
                                                </tr>
                                            }
                                            <tr style="border-left: 1px solid #c6c6c6;border-right: 1px solid #c6c6c6;">
                                                <td align="left" style="padding: 1px 5px;">@item.FullName</td>
                                                <td align="center" style="padding: 1px 5px;color:#7030A0;">@item.LeadCount</td>
                                                <td align="center" style="padding: 1px 5px;color:#2E72C4;">@item.RNCCount</td>
                                                <td align="center" style="padding: 1px 5px;color:#00B050;">@item.REGCount</td>
                                                <td align="center" style="padding: 1px 5px;color:#FF0000;">@item.DingCount</td>
                                                <td align="right" style="padding: 1px 5px;">@item.Commission.Value.ToString("n2")</td>
                                            </tr>
                                        }
                                        else
                                        {
                                            <tr style="border-left: 1px solid #c6c6c6;border-right: 1px solid #c6c6c6;">
                                                <td align="left" style="padding: 1px 5px;">@item.FullName</td>
                                                <td align="center" style="padding: 1px 5px;color:#7030A0;">@item.LeadCount</td>
                                                <td align="center" style="padding: 1px 5px;color:#2E72C4;">@item.RNCCount</td>
                                                <td align="center" style="padding: 1px 5px;color:#00B050;">@item.REGCount</td>
                                                <td align="center" style="padding: 1px 5px;color:#FF0000;">@item.DingCount</td>
                                                <td align="right" style="padding: 1px 5px;">@item.Commission.Value.ToString("n2")</td>
                                            </tr>
                                        }
                                        traderIdd = item.TraderId;
                                    }
                                    @*
                                        <tr style="border-top: 1px solid black;">
                                           <td style="padding:10px 30px;" colspan="6"></td>
                                        </tr>
                                    *@
                                }
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <script>
        $(document).ready(function () {


        });
    </script>
